<PageFunction
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:sys="clr-namespace:System;assembly=System.Runtime"
    x:Class="CarmenUI.Pages.ConfigureItems"
    x:TypeArguments="sys:Boolean"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:CarmenUI.Pages"
    xmlns:modelStructure="clr-namespace:ShowModel.Structure;assembly=ShowModel"
    xmlns:cv="clr-namespace:CarmenUI.Converters"
    mc:Ignorable="d"
    d:DesignHeight="600" d:DesignWidth="800"
    Title="Configure Items">
    <Page.Resources>
        <CollectionViewSource x:Key="rootNodesViewSource"/>
        <cv:SortIOrdered x:Key="sortIOrdered" />
    </Page.Resources>
    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <DockPanel>
            <TreeView DockPanel.Dock="Left" x:Name="ItemsTreeView" Margin="5" KeyDown="ItemsTreeView_KeyDown"
                            ItemsSource="{Binding Source={StaticResource rootNodesViewSource}}"
                            MinWidth="150" MaxWidth="400" AllowDrop="True"
                            PreviewMouseLeftButtonDown="ItemsTreeView_PreviewMouseLeftButtonDown"
                            MouseMove="ItemsTreeView_MouseMove" 
                            DragOver="ItemsTreeView_DragOver" 
                            Drop="ItemsTreeView_Drop">
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type modelStructure:ShowRoot}" ItemsSource="{Binding Children, Converter={StaticResource sortIOrdered}}">
                        <TextBlock Text="{Binding Path=Name, StringFormat='Show: {0}'}"/>
                    </HierarchicalDataTemplate>
                    <HierarchicalDataTemplate DataType="{x:Type modelStructure:Section}" ItemsSource="{Binding Children, Converter={StaticResource sortIOrdered}}">
                        <TextBlock Text="{Binding Path=Name, StringFormat='Section: {0}'}"/>
                    </HierarchicalDataTemplate>
                    <HierarchicalDataTemplate DataType="{x:Type modelStructure:Item}">
                        <TextBlock Text="{Binding Path=Name, StringFormat='Item: {0}'}"/>
                    </HierarchicalDataTemplate>
                </TreeView.Resources>
            </TreeView>
            <TextBlock Text="blah"/>
        </DockPanel>
        <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right">
            <Button x:Name="CancelButton" IsCancel="True" Width="100" Height="35" Margin="5" Click="CancelButton_Click">
                <StackPanel Orientation="Horizontal">
                    <Image Source="/Icons/Cancel_grey_16x.png" Width="16" Margin="2 0"/>
                    <TextBlock Text="Cancel" Margin="2 0"/>
                </StackPanel>
            </Button>
            <Button x:Name="SaveButton" IsDefault="True" Width="100" Height="35" Margin="5" Click="SaveButton_Click">
                <StackPanel Orientation="Horizontal">
                    <Image Source="/Icons/Checkmark_blue_16x.png" Width="16" Margin="2 0"/>
                    <TextBlock Text="Save" Margin="2 0"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</PageFunction>